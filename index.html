<!doctype html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
<title>Bristol Bloods</title>

<style>
  :root{
    color-scheme: dark;
    --stack: 680px;
    --stack-mobile: 360px;
    --red: #ff3b3b;
    --head: 0px; /* set dynamically */
  }

  html, body { height: 100%; margin: 0; background:#000; color:#fff; font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; }

  /* ===== Header (navbar only; no logo) ===== */
  header {
    padding:12px 20px 10px;
    border-bottom:1px solid #151515;
  }
  nav { display:flex; align-items:center; gap:18px; justify-content:flex-end; }
  nav a {
    color:#cfcfcf; text-decoration:none; font-size:14px; padding:6px 2px;
    border-bottom:2px solid transparent; transition:border-color .15s,color .15s;
  }
  nav a:hover { color:#fff; border-color:#ff3b3b; }
  nav a[aria-current="page"] { color:#fff; border-color:#ff3b3b; }
  @media (max-width:520px){ nav{ justify-content:center; } }

  /* ===== Hero ===== */
  .wrap{
    width:100%;
    min-height: calc(100dvh - var(--head)); /* center in remaining viewport */
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    padding: 24px 16px;
  }
  .stack{ width:min(92vw, var(--stack)); margin-inline:auto; text-align:center; }

  .logo{ margin: 2vh auto 10px; }
  .logo picture{ display:block }
  .logo img{ width:100%; height:auto; display:block }

  .sub{ margin:0 0 18px; color:#bdbdbd; font-weight:700; letter-spacing:.2px; font-size:clamp(16px,2.2vw,22px); }

  /* Reveal row: input + button fused */
  .reveal{
    display:flex; align-items:stretch; justify-content:center;
    margin: 6px auto 6px;
    /* no width here so .stack width applies */
  }
  .input{
    box-sizing:border-box; flex:1 1 auto;
    padding:14px 16px; border:1px solid #2a2a2a; border-right:0;
    border-radius:12px 0 0 12px; background:#0f0f0f; color:#fff; outline:none;
  }
  .input::placeholder{ color:#6b6b6b }
  .btn{
    box-sizing:border-box; flex:0 0 auto;
    padding:14px 18px; border:1px solid var(--red); border-left:0;
    border-radius:0 12px 12px 0; background:var(--red); color:#fff;
    font-weight:800; cursor:pointer; transition:filter .2s ease, transform .08s ease;
  }
  .btn:hover{ filter:brightness(1.05) }
  .btn:active{ transform:scale(.98) }

  .hint{ color:#8b8b8b; font-size:13px; margin-top:14px; }

  /* Mobile swaps to stacked logo asset + narrower stack */
  @media (max-width: 560px){
    .stack{ width:min(92vw, var(--stack-mobile)); }
    .logo img{ content:url("/assets/logo-red-stacked.svg"); }
  }

  /* Error + toast (unchanged) */
  .error { min-height:18px; color:#ff6b6b; font-size:13px; margin-top:6px; }
  .input.error { border-color:#ff6b6b !important; box-shadow:0 0 0 3px rgba(255,107,107,.2); }
  @media (prefers-reduced-motion: no-preference) {
    .shake { animation: shake .18s ease-in-out 0s 1; }
    @keyframes shake { 0%{transform:translateX(0)}25%{transform:translateX(-3px)}50%{transform:translateX(3px)}75%{transform:translateX(-2px)}100%{transform:translateX(0)} }
  }
  .toast {
    position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
    background:#222; color:#fff; padding:16px 20px; border:1px solid #444; border-radius:10px;
    box-shadow:0 8px 24px rgba(0,0,0,.5); z-index:9999; max-width:90vw; text-align:center;
  }
  .toast-msg { margin-bottom:12px; }
  .toast-btn { background:#e11; color:#fff; border:none; border-radius:6px; padding:6px 14px; font-weight:700; cursor:pointer; }
  .toast-btn:hover { background:#c00; }
</style>

<header>
  <nav>
    <a href="/" aria-current="page">Home</a>
    <a href="/keepers">Keepers</a>
    <a href="/draft">Draft Order</a>
  </nav>
</header>

<div class="wrap">
  <div class="logo stack">
    <picture>
      <source srcset="/assets/logo-red-stacked.svg" media="(max-width: 560px)">
      <img src="/assets/logo-red-wide.svg" alt="Bristol Bloods">
    </picture>
  </div>

  <div class="sub stack">Labor Day Massacre â€” 7:30pm EST</div>

  <div class="reveal stack" id="revealRow">
    <input id="name" class="input" placeholder="Your first name" autocomplete="given-name" />
    <button id="go" class="btn">Reveal My Fate</button>
  </div>

  <div id="nameError" class="error stack" role="alert" aria-live="polite"></div>
  <div class="hint stack">Disclaimer: Draft is subject to change.</div>
</div>

<script>
  // Keep hero perfectly centered beneath whatever header height is rendered
  function setHeaderVar() {
    const h = document.querySelector('header')?.offsetHeight || 0;
    document.documentElement.style.setProperty('--head', h + 'px');
  }
  setHeaderVar();
  addEventListener('resize', setHeaderVar);
  addEventListener('orientationchange', setHeaderVar);
  if (document.fonts) document.fonts.ready.then(setHeaderVar);

  const input = document.getElementById('name');
  const goBtn = document.getElementById('go');
  const errEl = document.getElementById('nameError');

  const LEAGUE_NAMES = [
    "kyle","amy","james","jared","kristyn","chino","justin","erica","mike",
    "chris","tom","thomas","ovidiu","michael","aimee","trav","travis","tommy","ovi"
  ];

  const ROASTS = {
    "chris": "Who the fuck is Chris?",
    "tom": "Didn't you mean fucking Tommy?",
    "thomas": "Didn't you mean fucking Tommy?",
    "ovidiu": "Get that diu outta here it's Ovi!",
    "michael": "What is this catholic school? It's plain old Mike",
    "aimee": "We only accept the Asian spelling of this name.",
    "trav": "Spell the name out asshole!",
  };

  function showToast(msg, onDismiss) {
    const toast = document.createElement('div');
    toast.className = 'toast';
    toast.innerHTML = `
      <div class="toast-msg">${msg}</div>
      <button class="toast-btn">Dismiss</button>
    `;
    document.body.appendChild(toast);
    document.querySelector('.toast-btn').onclick = () => {
      toast.remove();
      if (onDismiss) onDismiss();
    };
  }

  function validateName(raw) {
    const name = (raw || "").trim();
    if (!name) return { ok:false, msg:"Don't know your own fucking name?" };
    if (name.length < 2) return { ok:false, msg:"Name must be at least 2 characters." };
    if (name.length > 20) return { ok:false, msg:"Name must be 20 characters or fewer." };

    const slug = name.toLowerCase();

    if (ROASTS[slug]) return { ok:false, msg:ROASTS[slug] };

    if (slug === "james") {
      showToast("Didn't you mean Jim or Jimbo? Just kidding CHAMP!", () => { proceed(name); });
      return { ok:false, msg:null };
    }
    if (slug === "jared") {
      showToast("Now I know you're old, no longer JROD. SMH You will always be JROD to me pal.", () => { proceed(name); });
      return { ok:false, msg:null };
    }

    if (!LEAGUE_NAMES.includes(slug)) {
      return { ok:false, msg:"Who the fuck are you? Get outta here" };
    }

    return { ok:true, name };
  }

  function showError(msg) {
    if (!msg) return;
    input.classList.add('error','shake');
    errEl.textContent = msg;
    setTimeout(()=>input.classList.remove('shake'), 220);
  }
  function clearError() {
    input.classList.remove('error');
    errEl.textContent = "";
  }

  function proceed(validName) {
    clearError();
    location.href = `/reveal/?name=${encodeURIComponent(validName)}`;
  }

  function submit() {
    const v = validateName(input.value);
    if (!v.ok) {
      if (v.msg) showError(v.msg); // toast cases skip this
      return;
    }
    proceed(v.name);
  }

  goBtn.addEventListener('click', submit);
  input.addEventListener('keydown', e => { if (e.key === 'Enter') submit(); });
</script>
